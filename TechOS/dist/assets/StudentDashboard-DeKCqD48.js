import{a as q,u as z,r as o,w as m,j as e}from"./index-Craug-YI.js";import{B as v}from"./button-D5YUjWo4.js";import{C as S,a as _,b as E,c as k,d as D}from"./card-cHz5kV7I.js";import{T as W,a as F,b as B,c as L,d as G,e as O}from"./table-jnHpQ0_K.js";import{S as h}from"./skeleton-DXrWeBCp.js";import{u as J,L as K}from"./LanguageSwitcher-DeaRDNze.js";import{U as P}from"./user-CnEKsD7I.js";import{C as Q,a as V}from"./clock-BfV1pI8f.js";import{B as U}from"./book-open-CtZhBFJg.js";const oe=()=>{const{user:t,signOut:A}=q(),x=z(),{t:u}=J(),[d,f]=o.useState([]),[j,p]=o.useState([]),[N,i]=o.useState(!0);o.useEffect(()=>{t&&H()},[t]);const H=async()=>{if(t){i(!0);try{const{data:s,error:r}=await m.from("enrollments").select("course_id").eq("student_id",t.id);if(r)throw r;if(!s||s.length===0){f([]),p([]),i(!1);return}const $=s.map(a=>a.course_id),{data:n,error:y}=await m.from("courses").select("*, schedules(*)").in("id",$);if(y)throw y;const R=[...new Set(n==null?void 0:n.map(a=>a.teacher_id))],{data:l,error:w}=await m.from("profiles").select("id, first_name, last_name").in("id",R);if(w)throw w;const b=new Map;l==null||l.forEach(a=>{b.set(a.id,`${a.first_name} ${a.last_name}`)});const T=(n||[]).map(a=>({...a,teacherName:b.get(a.teacher_id)||"Unknown"}));f(T);const Y=new Date().getDay(),C=[];T.forEach(a=>{a.schedules.filter(c=>c.day_of_week===Y).forEach(c=>{C.push({courseName:a.name,teacherName:a.teacherName,startTime:c.start_time,endTime:c.end_time})})}),p(C)}catch(s){console.error("Error fetching student data:",s)}finally{i(!1)}}},M=async()=>{await A(),x("/login")},g=s=>new Date(`2000-01-01T${s}`).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0});return e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx("header",{className:"border-b bg-card",children:e.jsxs("div",{className:"container mx-auto flex h-16 items-center justify-between px-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:u("studentDashboard")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{}),e.jsx(v,{onClick:()=>x("/profile"),variant:"ghost",size:"icon",children:e.jsx(P,{className:"h-5 w-5"})}),e.jsx(v,{onClick:M,variant:"outline",children:u("signOut")})]})]})}),e.jsxs("main",{className:"container mx-auto p-6 max-w-5xl",children:[e.jsxs(S,{className:"mb-6",children:[e.jsxs(_,{children:[e.jsx(E,{children:"Today's Schedule"}),e.jsx(k,{children:"Your classes for today"})]}),e.jsx(D,{children:N?e.jsx("div",{className:"space-y-4",children:[...Array(3)].map((s,r)=>e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{className:"h-6 w-48"}),e.jsx(h,{className:"h-4 w-32"})]},r))}):j.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Q,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"No classes scheduled for today"})]}):e.jsx("div",{className:"space-y-4",children:j.map((s,r)=>e.jsxs("div",{className:"flex items-start gap-4 p-4 rounded-lg border bg-card",children:[e.jsx(U,{className:"h-5 w-5 text-primary mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-lg",children:s.courseName}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.teacherName}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground mt-1",children:[e.jsx(V,{className:"h-4 w-4"}),e.jsxs("span",{children:[g(s.startTime)," - ",g(s.endTime)]})]})]})]},r))})})]}),e.jsxs(S,{children:[e.jsxs(_,{children:[e.jsx(E,{children:"My Courses"}),e.jsxs(k,{children:[d.length," enrolled courses"]})]}),e.jsx(D,{children:N?e.jsx("div",{className:"space-y-2",children:[...Array(5)].map((s,r)=>e.jsx(h,{className:"h-12 w-full"},r))}):d.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(U,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"You are not enrolled in any courses"})]}):e.jsxs(W,{children:[e.jsx(F,{children:e.jsxs(B,{children:[e.jsx(L,{children:"Course Name"}),e.jsx(L,{children:"Teacher"})]})}),e.jsx(G,{children:d.map(s=>e.jsxs(B,{children:[e.jsx(O,{className:"font-medium",children:s.name}),e.jsx(O,{children:s.teacherName})]},s.id))})]})})]})]})]})};export{oe as default};
